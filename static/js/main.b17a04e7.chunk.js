(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{48:function(e,n,t){e.exports=t(99)},99:function(e,n,t){"use strict";t.r(n);var r=t(7),o=t(0),a=t.n(o),i=t(34),c=t.n(i),l=t(5),u=t(3),s=t(2);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var d=t(8),h=t(9),f=t(14),g=t(13),b=t(15),v=t(37),m={primaryColor:"#a5d6a7",primaryLightColor:"#d7ffd9",primaryDarkColor:"#75a478",primaryTextColor:"#000000",backgroundGreyColor:"#e8e8e8",backgroundWhiteColor:"#fff"};function p(){var e=Object(r.a)(["\n  width: 32rem;\n  padding: 1.2rem;\n  background-color: ",";\n  border: 1px solid ",";\n  border-radius: 0.8rem;\n  text-align: center;\n  text-decoration: none;\n  color: ",";\n\n  &:focus {\n    outline: none;\n  }\n\n  &:hover {\n    background-color: ",";\n    box-shadow: 0.1rem 0.1rem 0.3rem 0 rgba(0, 0, 0, 0.75);\n  }\n"]);return p=function(){return e},e}function y(){var e=Object(r.a)(["\n  width: 100%;\n  height: 100%;\n  font-size: 1rem;\n\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  background-color: ",";\n"]);return y=function(){return e},e}var w=l.c.div(y(),m.backgroundGreyColor),O=Object(l.c)(v.a).attrs({type:"button"})(p(),m.backgroundWhiteColor,m.backgroundGreyColor,m.primaryTextColor,m.primaryLightColor),k=function(e){function n(){return Object(d.a)(this,n),Object(f.a)(this,Object(g.a)(n).apply(this,arguments))}return Object(b.a)(n,e),Object(h.a)(n,[{key:"render",value:function(){return o.createElement(w,null,o.createElement(O,{to:"/single"},o.createElement("span",null,"Single Play")))}}]),n}(o.PureComponent);function C(){var e=Object(r.a)(["\n  width: 100%;\n  height: 100%;\n  font-size: 1rem;\n\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n\n  background-color: ",";\n"]);return C=function(){return e},e}var j=l.c.div(C(),m.backgroundGreyColor),B=t(40),E=t(41),x=t.n(E),z=t(42),S=t.n(z);function P(){var e=Object(r.a)(["\n  width: ",";\n  height: ",";\n  background-color: ",";\n"]);return P=function(){return e},e}var R=l.c.canvas(P(),(function(e){return"".concat((e.width/10).toFixed(1),"rem")}),(function(e){return"".concat((e.height/10).toFixed(1),"rem")}),m.backgroundWhiteColor),G=t(43);function A(e,n){return Math.floor(Math.random()*(+n-+e))+ +e}var K=t(24),I=t(44),M=t.n(I),D=t(45),W=t.n(D),F=function(e,n){var t=e.length,r=e.filter((function(e){return Boolean(e.value)})),o=M()(Array(t-r.length),{value:0});return"left"===n?r.concat(o):o.concat(r)},H=function(e){var n=F(e,"left");return L(n)},T=function(e){var n=F(e,"right");return L(n.reverse()).reverse()},L=function(e){for(var n=Object(K.a)(e),t=0;t<n.length;t++){var r=n[t],o=n[t+1];r&&o&&r.value===o.value&&0!==r.value&&(r.value+=o.value,o.value=0,t+=1)}return F(n,"left")},N=function(e){return W.a.apply(void 0,Object(K.a)(e)).map((function(e){return e.map((function(e){return Boolean(e)?e:{value:0}}))}))},J=function(){function e(){var n=this;Object(d.a)(this,e),this.currentBoardSize=0,this.generateBlockCountPerMove=1,this.board=[],this.isInitialized=!1,this.startValue=2,this.maxBoardSearchCount=4,this.onBoardChange=function(){},this.onGameEnd=function(){},this.getBoard=function(){return n.board},this.newBlockAtRandomPosition=function(){if(!n.isInitialized)throw new Error("[\u274c] error: Must be initialize before use!");for(var e=0;e<n.generateBlockCountPerMove;e++)n.getEmptyRandomPosition().then((function(e){var t=e.x,r=e.y;console.log("!!!! {x,y}: {".concat(t,", ").concat(r,"}")),n.board[t][r]={value:n.startValue},n.onBoardChange(n.board)})).catch((function(){console.log("!!! no space"),n.onGameEnd()}))},this.getEmptyRandomPosition=function(){return new Promise((function(e,t){var r,o,a=1;console.time("getEmptyRandomPosition");do{if(a===n.maxBoardSearchCount){r=null,o=null;break}r=A(0,n.currentBoardSize),o=A(0,n.currentBoardSize),a++}while(!n.isEmpty(r,o));console.timeEnd("getEmptyRandomPosition"),null!==r&&null!==o?e({x:r,y:o}):t()}))},this.isEmpty=function(e,t){return 0===n.board[e][t].value}}return Object(h.a)(e,[{key:"initializeBoard",value:function(e){var n=e.boardSize,t=e.onBoardChange,r=e.onGameEnd;this.currentBoardSize=n,this.generateBlockCountPerMove=Math.round(n/2),this.maxBoardSearchCount=Math.pow(n,n),this.onBoardChange=t,this.onGameEnd=r,this.board=new Array(n);for(var o=0;o<n;o++)this.board[o]=Object(G.fill)(new Array(n),{value:0});this.isInitialized=!0,this.newBlockAtRandomPosition()}},{key:"move",value:function(e){this.board=function(e,n){for(var t="up"===n||"down"===n,r=t?N(e):e,o=Array(e.length),a=0;a<r.length;a++)switch(n){case"up":case"left":o[a]=H(r[a]);break;case"down":case"right":o[a]=T(r[a])}return t?N(o):o}(this.board,e),this.onBoardChange(this.board),this.newBlockAtRandomPosition()}}]),e}(),V=function(){return{r:A(0,255),g:A(0,255),b:A(0,255)}},X={2:{r:0,g:0,b:0},4:{r:0,g:0,b:0},8:{r:0,g:0,b:0},16:{r:0,g:0,b:0},32:{r:0,g:0,b:0},64:{r:0,g:0,b:0},128:{r:0,g:0,b:0},256:{r:0,g:0,b:0},512:{r:0,g:0,b:0},1024:{r:0,g:0,b:0},2048:{r:0,g:0,b:0}};!function(){for(var e=0,n=Object.keys(X);e<n.length;e++){var t=n[e];X[t]=V()}}();var Y=X;function $(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}var q=function(e){function n(){var e,t;Object(d.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(t=Object(f.a)(this,(e=Object(g.a)(n)).call.apply(e,[this].concat(a)))).state={canvasWidth:0,canvasHeight:0},t.engine=new J,t.refCanvasBoard=o.createRef(),t.canvasContext=null,t.getRelativeBlockSize=S()((function(e){var n=e.canvasWidth,t=e.canvasHeight,r=e.boardSize;return{width:n/r,height:t/r}})),t.drawRect=function(e){var n=t.canvasContext,r=t.getRelativeBlockSize(function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?$(t,!0).forEach((function(n){Object(B.a)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):$(t).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}({},t.state,{boardSize:t.props.boardSize})),o=r.width,a=r.height;if(n){var i=e.posX,c=e.posY,l=e.block,u=Y[l.value],s=u.r,d=u.g,h=u.b,f=i*o,g=c*a;n.fillStyle="rgba(".concat(s,", ").concat(d,", ").concat(h,", 0.8)"),n.fillRect(g,f,o,a),n.fillStyle="".concat(m.primaryTextColor),n.font="2.0rem Noto Sans KR",n.textAlign="center",n.fillText("".concat(l.value),g+o/2,f+a/2)}},t.clearBoard=function(){var e=t.canvasContext,n=t.state,r=n.canvasWidth,o=n.canvasHeight;e&&e.clearRect(0,0,r,o)},t.renderBoard=function(e){var n=t.props.boardSize;t.clearBoard();for(var r=0;r<n;r++)for(var o=0;o<n;o++){var a=e[r][o];a.value&&t.drawRect({posX:r,posY:o,block:a})}},t.initializeGameEngine=function(){var e=t.props.boardSize;t.engine.initializeBoard({boardSize:e,onBoardChange:t.handleBoardChange,onGameEnd:t.handleGameEnd}),console.info("[\u2714\ufe0f] Success to initialize Game engine")},t.initializeCanvas=function(){var e=t.refCanvasBoard.current;e?(t.canvasContext=e.getContext("2d"),t.canvasContext&&(console.info("[\u2714\ufe0f] Success to initialize canvas"),t.setState({canvasWidth:e.width,canvasHeight:e.height}),t.renderBoard(t.engine.getBoard()),t.registerKeyboardInput())):console.error("[\u274c] Failed to initialize canvas")},t.registerKeyboardInput=function(){window?(window.addEventListener("keydown",t.debounceKeyDown),console.info("[\u2714\ufe0f] Success to register keyboard input")):console.error("[\u274c] Failed to register keyboard input")},t.handleBoardChange=function(e){console.log("!!!! handleBoardChange",e),t.renderBoard(e)},t.handleGameEnd=function(){alert(" - GAME END - ")},t.handleArrowKey=function(e){var n=null;switch(e.keyCode){case 37:console.log("KeyInput: left arrow"),n="left";break;case 38:console.log("KeyInput: up arrow"),n="up";break;case 39:console.log("KeyInput: right arrow"),n="right";break;case 40:console.log("KeyInput: down arrow"),n="down"}n&&t.engine.move(n)},t.debounceKeyDown=x()(t.handleArrowKey,150),t}return Object(b.a)(n,e),Object(h.a)(n,[{key:"componentDidMount",value:function(){this.initializeGameEngine(),this.initializeCanvas()}},{key:"render",value:function(){var e=this.props,n=e.width,t=e.height;return o.createElement(R,{width:n,height:t,ref:this.refCanvasBoard})}}]),n}(o.PureComponent),Q=function(e){function n(){return Object(d.a)(this,n),Object(f.a)(this,Object(g.a)(n).apply(this,arguments))}return Object(b.a)(n,e),Object(h.a)(n,[{key:"render",value:function(){return o.createElement(j,null,o.createElement("title",null,o.createElement("h1",null,"Single play mode")),o.createElement("div",null,o.createElement(q,{width:500,height:500,boardSize:4})))}}]),n}(o.PureComponent);function U(){var e=Object(r.a)(["\n  html,\n  body {\n    margin: 0;\n    padding: 0;\n    font-size: 10px;\n  }\n\n  * {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n    font-family: 'Noto Sans KR', sans-serif;\n  }\n\n  #root,\n  body {\n    width: 100vw;\n    height: 100vh;\n  }\n"]);return U=function(){return e},e}var Z=Object(l.b)(U()),_=Object(s.a)();c.a.render(a.a.createElement(l.a,{theme:{}},a.a.createElement(a.a.Fragment,null,a.a.createElement(Z,null),a.a.createElement(u.b,{history:_},a.a.createElement(u.c,null,a.a.createElement(u.a,{path:"/single",exact:!0,component:Q}),a.a.createElement(u.a,{path:"/",component:k}))))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[48,1,2]]]);
//# sourceMappingURL=main.b17a04e7.chunk.js.map