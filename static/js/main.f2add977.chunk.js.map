{"version":3,"sources":["serviceWorker.ts","theme.tsx","pages/landing/styled.tsx","pages/landing/index.tsx","pages/single/styled.tsx","gameEngine/render/styled.tsx","gameEngine/helpers/rangeRand.tsx","gameEngine/helpers/blockMergeHelper.tsx","gameEngine/engine/index.tsx","gameEngine/helpers/randomRGB.tsx","gameEngine/helpers/getBlockColor.tsx","gameEngine/render/index.tsx","pages/single/index.tsx","index.tsx"],"names":["Boolean","window","location","hostname","match","mainTheme","primaryColor","primaryLightColor","primaryDarkColor","primaryTextColor","backgroundGreyColor","backgroundWhiteColor","Wrapper","styled","div","MenuBox","Link","attrs","type","Landing","to","React","Header","header","Button","button","CanvasBoard","canvas","props","width","toFixed","height","rangeRand","min","max","Math","floor","random","arrayReorder","row","startFrom","length","newRow","filter","block","value","padArray","fill","Array","concat","moveToLeft","sortedRow","merge","moveToRight","reverse","arr","newArr","i","l","r","boardRotate","board","zip","map","Board2048Engine","currentBoardSize","generateBlockCountPerMove","isInitialized","startValue","maxBoardSearchCount","onBoardChange","onGameEnd","getBoard","newBlockAtRandomPosition","Error","getEmptyRandomPosition","then","result","x","y","catch","Promise","resolve","reject","tryCount","console","time","isEmpty","timeEnd","options","boardSize","this","round","pow","direction","needRotate","rotatedBoard","newBoard","boardMergeHandler","randomRGB","g","b","BlockColor","Object","keys","key","Board2048","state","canvasWidth","canvasHeight","engine","refCanvasBoard","canvasContext","restart","initializeGameEngine","getRelativeBlockSize","mem","param","drawRect","params","ctx","posX","posY","calPosY","calPosX","fillStyle","fillRect","font","textAlign","fillText","clearBoard","clearRect","renderBoard","initializeBoard","handleBoardChange","handleGameEnd","info","initializeCanvas","current","getContext","setState","registerKeyboardInput","error","addEventListener","debounceKeyDown","alert","handleArrowKey","e","keyCode","move","throttle","ref","SingleMode","refBoard","handleRestart","onClick","GlobalStyle","createGlobalStyle","history","createBrowserHistory","ReactDOM","render","theme","path","exact","component","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.f2add977.chunk.js","sourcesContent":["// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","export const mainTheme = {\n  primaryColor: \"#a5d6a7\",\n  primaryLightColor: \"#d7ffd9\",\n  primaryDarkColor: \"#75a478\",\n  primaryTextColor: \"#000000\",\n  backgroundGreyColor: \"#e8e8e8\",\n  backgroundWhiteColor: \"#fff\",\n};\n","import styled from \"styled-components\";\nimport { Link } from \"react-router-dom\";\nimport { mainTheme } from \"../../theme\";\n\nexport const Wrapper = styled.div`\n  width: 100%;\n  height: 100%;\n  font-size: 1rem;\n\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  background-color: ${mainTheme.backgroundGreyColor};\n`;\n\nexport const MenuBox = styled(Link).attrs({ type: \"button\" })`\n  width: 32rem;\n  padding: 1.2rem;\n  background-color: ${mainTheme.backgroundWhiteColor};\n  border: 1px solid ${mainTheme.backgroundGreyColor};\n  border-radius: 0.8rem;\n  text-align: center;\n  text-decoration: none;\n  color: ${mainTheme.primaryTextColor};\n\n  &:focus {\n    outline: none;\n  }\n\n  &:hover {\n    background-color: ${mainTheme.primaryLightColor};\n    box-shadow: 0.1rem 0.1rem 0.3rem 0 rgba(0, 0, 0, 0.75);\n  }\n`;\n","import * as React from \"react\";\nimport { RouteComponentProps } from \"react-router\";\nimport { Wrapper, MenuBox } from \"./styled\";\n\ninterface IProps extends RouteComponentProps {}\n\nexport default class Landing extends React.PureComponent<IProps> {\n  public render() {\n    return (\n      <Wrapper>\n        <MenuBox to=\"/single\">\n          <span>Single Play</span>\n        </MenuBox>\n      </Wrapper>\n    );\n  }\n}\n","import styled from \"styled-components\";\nimport { mainTheme } from \"../../theme\";\n\nexport const Wrapper = styled.div`\n  width: 100%;\n  height: 100%;\n  font-size: 1rem;\n\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n\n  background-color: ${mainTheme.backgroundGreyColor};\n`;\n\nexport const Header = styled.header`\n  margin-bottom: 2rem;\n`;\n\nexport const Button = styled.button`\n  padding: 0.4rem;\n  font-size: 1.2rem;\n  border-radius: 2rem;\n  margin-left: 1rem;\n`;\n","import styled from \"styled-components\";\nimport { mainTheme } from \"../../theme\";\n\nexport const CanvasBoard = styled.canvas<{ width: number; height: number }>`\n  width: ${props => `${(props.width / 10).toFixed(1)}rem`};\n  height: ${props => `${(props.height / 10).toFixed(1)}rem`};\n  background-color: ${mainTheme.backgroundWhiteColor};\n`;\n","export default function rangeRand(min: number, max: number) {\n  return Math.floor(Math.random() * (+max - +min)) + +min;\n}\n","import fill from \"lodash/fill\";\nimport zip from \"lodash/zip\";\nimport { Direction, Board, IBlock } from \"../engine\";\n\nconst arrayReorder = (\n  row: Array<IBlock>,\n  startFrom: \"left\" | \"right\",\n): Array<IBlock> => {\n  const length = row.length;\n  const newRow = row.filter(block => Boolean(block.value));\n  const padArray = fill(Array(length - newRow.length), { value: 0 });\n  return startFrom === \"left\"\n    ? newRow.concat(padArray)\n    : padArray.concat(newRow);\n};\n\nexport const moveToLeft = (row: Array<IBlock>): Array<IBlock> => {\n  const sortedRow = arrayReorder(row, \"left\");\n  return merge(sortedRow);\n};\n\nexport const moveToRight = (row: Array<IBlock>): Array<IBlock> => {\n  const sortedRow = arrayReorder(row, \"right\");\n  return merge(sortedRow.reverse()).reverse();\n};\n\nconst merge = (arr: Array<IBlock>) => {\n  const newArr = [...arr];\n  for (let i = 0; i < newArr.length; i++) {\n    const l = newArr[i];\n    const r = newArr[i + 1];\n    if (l && r && l.value === r.value && l.value !== 0) {\n      l.value += r.value;\n      r.value = 0;\n      i += 1;\n    }\n  }\n\n  return arrayReorder(newArr, \"left\");\n};\n\nconst boardRotate = (board: Board): Board =>\n  zip(...board).map(row =>\n    row.map(block => (Boolean(block) ? block : { value: 0 })),\n  ) as Board;\n\nexport const boardMergeHandler = (\n  board: Board,\n  direction: Direction,\n): Board => {\n  const needRotate = direction === \"up\" || direction === \"down\";\n  const rotatedBoard = needRotate ? boardRotate(board) : board;\n  // Think about their is exists only left and right\n  const newBoard = Array(board.length);\n  for (let i = 0; i < rotatedBoard.length; i++) {\n    switch (direction) {\n      case \"up\":\n      case \"left\": {\n        newBoard[i] = moveToLeft(rotatedBoard[i]);\n        break;\n      }\n\n      case \"down\":\n      case \"right\": {\n        newBoard[i] = moveToRight(rotatedBoard[i]);\n        break;\n      }\n    }\n  }\n\n  return needRotate ? boardRotate(newBoard) : newBoard;\n};\n","import { fill } from \"lodash\";\n\nimport rangeRand from \"../helpers/rangeRand\";\nimport { boardMergeHandler } from \"../helpers/blockMergeHelper\";\n\nexport interface IBlock {\n  value: number;\n}\nexport type Board = Array<Array<IBlock>>;\nexport type Direction = \"left\" | \"right\" | \"up\" | \"down\";\nexport type BoardChangeHandler = (board: Board) => void;\n\nexport default class Board2048Engine {\n  private currentBoardSize = 0;\n  private generateBlockCountPerMove = 1;\n  private board: Board = [];\n  private isInitialized = false;\n  private startValue = 2;\n  private maxBoardSearchCount = 4;\n  private onBoardChange: BoardChangeHandler = () => {};\n  private onGameEnd: VoidFunction = () => {};\n\n  public initializeBoard(options: {\n    boardSize: number;\n    onBoardChange: BoardChangeHandler;\n    onGameEnd: VoidFunction;\n  }) {\n    const { boardSize, onBoardChange, onGameEnd } = options;\n    this.currentBoardSize = boardSize;\n    this.generateBlockCountPerMove = Math.round(boardSize / 2);\n    this.maxBoardSearchCount = Math.pow(boardSize, boardSize);\n\n    this.onBoardChange = onBoardChange;\n    this.onGameEnd = onGameEnd;\n\n    this.board = new Array(boardSize);\n    for (let i = 0; i < boardSize; i++) {\n      this.board[i] = fill(new Array(boardSize), { value: 0 });\n    }\n    this.isInitialized = true;\n    this.newBlockAtRandomPosition();\n  }\n\n  public getBoard = () => this.board;\n\n  public move(direction: Direction) {\n    this.board = boardMergeHandler(this.board, direction);\n    this.onBoardChange(this.board);\n    this.newBlockAtRandomPosition();\n  }\n\n  private readonly newBlockAtRandomPosition = () => {\n    if (!this.isInitialized) {\n      throw new Error(\"[❌] error: Must be initialize before use!\");\n    }\n    for (let i = 0; i < this.generateBlockCountPerMove; i++) {\n      this.getEmptyRandomPosition()\n        .then(result => {\n          const { x, y } = result;\n          // console.log(`!!!! {x,y}: {${x}, ${y}}`);\n          this.board[x][y] = { value: this.startValue };\n          this.onBoardChange(this.board);\n        })\n        .catch(() => {\n          // console.log(\"!!! no space\");\n          this.onGameEnd(); // temporary\n        });\n    }\n  };\n\n  private readonly getEmptyRandomPosition = (): Promise<{\n    x: number;\n    y: number;\n  }> =>\n    new Promise((resolve, reject) => {\n      let x, y;\n      let tryCount = 1;\n\n      console.time(\"getEmptyRandomPosition\");\n      do {\n        if (tryCount === this.maxBoardSearchCount) {\n          x = null;\n          y = null;\n          break;\n        }\n        x = rangeRand(0, this.currentBoardSize);\n        y = rangeRand(0, this.currentBoardSize);\n        tryCount++;\n      } while (!this.isEmpty(x, y));\n      console.timeEnd(\"getEmptyRandomPosition\");\n\n      if (x !== null && y !== null) {\n        resolve({\n          x,\n          y,\n        });\n      } else {\n        reject();\n      }\n    });\n\n  private readonly isEmpty = (x: number, y: number) => {\n    return this.board[x][y].value === 0;\n  };\n}\n","import rangeRand from \"./rangeRand\";\n\nconst randomRGB = () => {\n  return {\n    r: rangeRand(0, 255),\n    g: rangeRand(0, 255),\n    b: rangeRand(0, 255),\n  };\n};\n\nexport default randomRGB;\n","import randomRGB from \"./randomRGB\";\n\nexport type BlockStage = \"2\" | \"4\" | \"8\" | \"16\" | \"32\" | \"64\" | \"128\" | \"256\" | \"512\" | \"1024\" | \"2048\";\nconst BlockColor: { [key: string]: { r: number; g: number; b: number } } = {\n  \"2\": { r: 0, g: 0, b: 0 },\n  \"4\": { r: 0, g: 0, b: 0 },\n  \"8\": { r: 0, g: 0, b: 0 },\n  \"16\": { r: 0, g: 0, b: 0 },\n  \"32\": { r: 0, g: 0, b: 0 },\n  \"64\": { r: 0, g: 0, b: 0 },\n  \"128\": { r: 0, g: 0, b: 0 },\n  \"256\": { r: 0, g: 0, b: 0 },\n  \"512\": { r: 0, g: 0, b: 0 },\n  \"1024\": { r: 0, g: 0, b: 0 },\n  \"2048\": { r: 0, g: 0, b: 0 }\n};\n\n(() => {\n  const keys = Object.keys(BlockColor);\n  for (const key of keys) {\n    BlockColor[key] = randomRGB();\n  }\n})();\n\nexport default BlockColor;\n","import * as React from \"react\";\nimport throttle from \"lodash/throttle\";\nimport mem from \"mem\";\nimport { CanvasBoard } from \"./styled\";\n\nimport Board2048Engine, {\n  Direction,\n  Board as GameBoard,\n  BoardChangeHandler,\n  IBlock,\n} from \"../engine\";\nimport { mainTheme } from \"../../theme\";\nimport BlockColor from \"../helpers/getBlockColor\";\n\n// const BLOCK_MARGIN = 8;\n\ninterface IProps {\n  width: number;\n  height: number;\n  boardSize: number;\n}\n\ninterface IState {\n  canvasWidth: number;\n  canvasHeight: number;\n}\n\nexport default class Board2048 extends React.PureComponent<IProps, IState> {\n  public state: IState = {\n    canvasWidth: 0,\n    canvasHeight: 0,\n  };\n\n  private readonly engine = new Board2048Engine();\n  private readonly refCanvasBoard = React.createRef<HTMLCanvasElement>();\n  private canvasContext: CanvasRenderingContext2D | null = null;\n\n  public componentDidMount() {\n    this.initializeGameEngine();\n    this.initializeCanvas();\n  }\n\n  public render() {\n    const { width, height } = this.props;\n    return (\n      <CanvasBoard width={width} height={height} ref={this.refCanvasBoard} />\n    );\n  }\n\n  public restart = () => {\n    this.initializeGameEngine();\n  };\n\n  private readonly getRelativeBlockSize = mem(\n    (param: {\n      canvasWidth: number;\n      canvasHeight: number;\n      boardSize: number;\n    }) => {\n      const { canvasWidth, canvasHeight, boardSize } = param;\n      return {\n        width: canvasWidth / boardSize,\n        height: canvasHeight / boardSize,\n      };\n    },\n  );\n\n  private readonly drawRect = (params: {\n    posX: number;\n    posY: number;\n    block: IBlock;\n  }) => {\n    const ctx = this.canvasContext;\n    const { width, height } = this.getRelativeBlockSize({\n      ...this.state,\n      boardSize: this.props.boardSize,\n    });\n    if (ctx) {\n      const { posX, posY, block } = params;\n      const { r, g, b } = BlockColor[block.value];\n      const calPosY = posX * width;\n      const calPosX = posY * height;\n      // box render\n      ctx.fillStyle = `rgba(${r}, ${g}, ${b}, 0.8)`;\n      ctx.fillRect(calPosX, calPosY, width, height);\n      // text render\n      ctx.fillStyle = `${mainTheme.primaryTextColor}`;\n      ctx.font = `2.0rem Noto Sans KR`;\n      ctx.textAlign = \"center\";\n      ctx.fillText(`${block.value}`, calPosX + width / 2, calPosY + height / 2);\n    }\n  };\n\n  private readonly clearBoard = () => {\n    const ctx = this.canvasContext;\n    const { canvasWidth, canvasHeight } = this.state;\n    if (ctx) {\n      ctx.clearRect(0, 0, canvasWidth, canvasHeight);\n    }\n  };\n\n  private readonly renderBoard = (board: GameBoard) => {\n    const { boardSize } = this.props;\n    this.clearBoard();\n    for (let x = 0; x < boardSize; x++) {\n      for (let y = 0; y < boardSize; y++) {\n        const block = board[x][y];\n        if (block.value) {\n          this.drawRect({\n            posX: x,\n            posY: y,\n            block: block,\n          });\n        }\n      }\n    }\n  };\n\n  private readonly initializeGameEngine = () => {\n    const { boardSize } = this.props;\n    this.engine.initializeBoard({\n      boardSize,\n      onBoardChange: this.handleBoardChange,\n      onGameEnd: this.handleGameEnd,\n    });\n    console.info(\"[✔️] Success to initialize Game engine\");\n  };\n\n  private readonly initializeCanvas = () => {\n    const canvas = this.refCanvasBoard.current;\n    if (canvas) {\n      this.canvasContext = canvas.getContext(\"2d\");\n      if (this.canvasContext) {\n        console.info(\"[✔️] Success to initialize canvas\");\n\n        this.setState({\n          canvasWidth: canvas.width,\n          canvasHeight: canvas.height,\n        });\n        this.renderBoard(this.engine.getBoard());\n\n        this.registerKeyboardInput();\n      }\n    } else {\n      console.error(\"[❌] Failed to initialize canvas\");\n    }\n  };\n\n  private readonly registerKeyboardInput = () => {\n    if (window) {\n      window.addEventListener(\"keydown\", this.debounceKeyDown);\n      console.info(\"[✔️] Success to register keyboard input\");\n    } else {\n      console.error(\"[❌] Failed to register keyboard input\");\n    }\n  };\n\n  private readonly handleBoardChange: BoardChangeHandler = board => {\n    this.renderBoard(board);\n  };\n\n  private readonly handleGameEnd = () => {\n    alert(\" - GAME END - \");\n  };\n\n  private readonly handleArrowKey: React.EventHandler<any> = e => {\n    let direction: Direction | null = null;\n    switch (e.keyCode) {\n      // left\n      case 37: {\n        direction = \"left\";\n        break;\n      }\n\n      // up\n      case 38: {\n        direction = \"up\";\n        break;\n      }\n\n      // right\n      case 39: {\n        direction = \"right\";\n        break;\n      }\n\n      // down\n      case 40: {\n        direction = \"down\";\n        break;\n      }\n    }\n    if (direction) {\n      this.engine.move(direction);\n    }\n  };\n  private readonly debounceKeyDown = throttle(this.handleArrowKey, 150);\n}\n","import * as React from \"react\";\nimport { RouteComponentProps } from \"react-router\";\nimport { Header, Wrapper, Button } from \"./styled\";\nimport Board2048 from \"../../gameEngine/render\";\n\ninterface IProps extends RouteComponentProps {}\n\nexport default class SingleMode extends React.PureComponent<IProps> {\n  private readonly refBoard = React.createRef<Board2048>();\n  public render() {\n    return (\n      <Wrapper>\n        <Header>\n          <h1>\n            Single play mode\n            <Button onClick={this.handleRestart}>Restart</Button>\n          </h1>\n        </Header>\n        <div>\n          <Board2048\n            ref={this.refBoard}\n            width={500}\n            height={500}\n            boardSize={4}\n          />\n        </div>\n      </Wrapper>\n    );\n  }\n\n  private readonly handleRestart = () => {\n    const board = this.refBoard.current;\n    if (board) {\n      board.restart();\n    }\n  };\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { createGlobalStyle, ThemeProvider } from \"styled-components\";\nimport { Router, Switch, Route } from \"react-router\";\nimport { createBrowserHistory } from \"history\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nimport Landing from \"./pages/landing\";\nimport SingleMode from \"./pages/single\";\n\nconst GlobalStyle = createGlobalStyle`\n  html,\n  body {\n    margin: 0;\n    padding: 0;\n    font-size: 10px;\n  }\n\n  * {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n    font-family: 'Noto Sans KR', sans-serif;\n  }\n\n  #root,\n  body {\n    width: 100vw;\n    height: 100vh;\n  }\n`;\n\nconst history = createBrowserHistory();\n\nReactDOM.render(\n  <ThemeProvider theme={{}}>\n    <>\n      <GlobalStyle />\n      <Router history={history}>\n        <Switch>\n          <Route path=\"/single\" exact={true} component={SingleMode} />\n          <Route path=\"/\" component={Landing} />\n        </Switch>\n      </Router>\n    </>\n  </ThemeProvider>,\n  document.getElementById(\"root\"),\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}