(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{38:function(e,n,t){e.exports=t(64)},64:function(e,n,t){"use strict";t.r(n);var r=t(7),o=t(0),a=t.n(o),i=t(26),c=t.n(i),l=t(5),u=t(3),s=t(2);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var d=t(8),h=t(9),g=t(13),v=t(12),f=t(14),b=t(29),m={primaryColor:"#a5d6a7",primaryLightColor:"#d7ffd9",primaryDarkColor:"#75a478",primaryTextColor:"#000000",backgroundGreyColor:"#e8e8e8",backgroundWhiteColor:"#fff"};function p(){var e=Object(r.a)(["\n  width: 32rem;\n  padding: 1.2rem;\n  background-color: ",";\n  border: 1px solid ",";\n  border-radius: 0.8rem;\n  text-align: center;\n  text-decoration: none;\n  color: ",";\n\n  &:focus {\n    outline: none;\n  }\n\n  &:hover {\n    background-color: ",";\n    box-shadow: 0.1rem 0.1rem 0.3rem 0 rgba(0, 0, 0, 0.75);\n  }\n"]);return p=function(){return e},e}function y(){var e=Object(r.a)(["\n  width: 100%;\n  height: 100%;\n  font-size: 1rem;\n\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  background-color: ",";\n"]);return y=function(){return e},e}var w=l.c.div(y(),m.backgroundGreyColor),O=Object(l.c)(b.a).attrs({type:"button"})(p(),m.backgroundWhiteColor,m.backgroundGreyColor,m.primaryTextColor,m.primaryLightColor),k=function(e){function n(){return Object(d.a)(this,n),Object(g.a)(this,Object(v.a)(n).apply(this,arguments))}return Object(f.a)(n,e),Object(h.a)(n,[{key:"render",value:function(){return o.createElement(w,null,o.createElement(O,{to:"/single"},o.createElement("span",null,"Single Play")))}}]),n}(o.PureComponent);function C(){var e=Object(r.a)(["\n  width: 100%;\n  height: 100%;\n  font-size: 1rem;\n\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n\n  background-color: ",";\n"]);return C=function(){return e},e}var j=l.c.div(C(),m.backgroundGreyColor),E=t(32),B=t(33),S=t.n(B),x=t(34),z=t.n(x);function P(){var e=Object(r.a)(["\n  width: ",";\n  height: ",";\n  background-color: ",";\n"]);return P=function(){return e},e}var R=l.c.canvas(P(),(function(e){return"".concat((e.width/10).toFixed(1),"rem")}),(function(e){return"".concat((e.height/10).toFixed(1),"rem")}),m.backgroundWhiteColor),G=t(35);function K(e,n){return Math.floor(Math.random()*(+n-+e))+ +e}var A=function(){function e(){var n=this;Object(d.a)(this,e),this.currentBoardSize=0,this.generateBlockCountPerMove=1,this.board=[],this.isInitialized=!1,this.startValue=2,this.maxBoardSearchCount=4,this.onBoardChange=function(){},this.onGameEnd=function(){},this.getBoard=function(){return n.board},this.newBlockAtRandomPosition=function(){if(!n.isInitialized)throw new Error("[\u274c] error: Must be initialize before use!");for(var e=0;e<n.generateBlockCountPerMove;e++)n.getEmptyRandomPosition().then((function(e){var t=e.x,r=e.y;console.log("!!!! {x,y}: {".concat(t,", ").concat(r,"}")),n.board[t][r]={value:n.startValue},n.onBoardChange(n.board)})).catch((function(){console.log("!!! no space"),n.onGameEnd()}))},this.getEmptyRandomPosition=function(){return new Promise((function(e,t){var r,o,a=1;console.time("getEmptyRandomPosition");do{if(a===n.maxBoardSearchCount){r=null,o=null;break}r=K(0,n.currentBoardSize),o=K(0,n.currentBoardSize),a++}while(!n.isEmpty(r,o));console.timeEnd("getEmptyRandomPosition"),null!==r&&null!==o?e({x:r,y:o}):t()}))},this.isEmpty=function(e,t){return 0===n.board[e][t].value}}return Object(h.a)(e,[{key:"initializeBoard",value:function(e){var n=e.boardSize,t=e.onBoardChange,r=e.onGameEnd;this.currentBoardSize=n,this.generateBlockCountPerMove=Math.round(n/2),this.maxBoardSearchCount=Math.pow(n,n),this.onBoardChange=t,this.onGameEnd=r,this.board=new Array(n);for(var o=0;o<n;o++)this.board[o]=Object(G.fill)(new Array(n),{value:0});this.isInitialized=!0,this.newBlockAtRandomPosition()}},{key:"move",value:function(e){console.log("!!!!! Direction: ",e);var n=this.board;switch(e){case"left":n=function(e){for(var n=JSON.parse(JSON.stringify(e)),t=0;t<n.length;t++)for(var r=n[t],o=0;o<r.length-1;o++){var a=r[o],i=o+1,c=void 0;do{c=r[i++]}while(0===c.value&&i<r.length);c.value!==a.value&&0!==a.value||(a.value=c.value+a.value,c.value=0)}return n}(this.board);break;case"right":n=function(e){for(var n=JSON.parse(JSON.stringify(e)),t=0;t<n.length;t++)for(var r=n[t],o=r.length-1,a=0;a<r.length-1;a++){var i=o-a,c=r[i],l=i-1,u=void 0;do{u=r[l--]}while(0===u.value&&l>=0);u.value!==c.value&&0!==c.value||(c.value=u.value+c.value,u.value=0)}return n}(this.board)}this.board=n,this.newBlockAtRandomPosition()}}]),e}(),D=function(){return{r:K(0,255),g:K(0,255),b:K(0,255)}},I={2:{r:0,g:0,b:0},4:{r:0,g:0,b:0},8:{r:0,g:0,b:0},16:{r:0,g:0,b:0},32:{r:0,g:0,b:0},64:{r:0,g:0,b:0},128:{r:0,g:0,b:0},256:{r:0,g:0,b:0},512:{r:0,g:0,b:0},1024:{r:0,g:0,b:0},2048:{r:0,g:0,b:0}};!function(){for(var e=0,n=Object.keys(I);e<n.length;e++){var t=n[e];I[t]=D()}}();var M=I;function W(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}var N=function(e){function n(){var e,t;Object(d.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(t=Object(g.a)(this,(e=Object(v.a)(n)).call.apply(e,[this].concat(a)))).state={canvasWidth:0,canvasHeight:0},t.engine=new A,t.refCanvasBoard=o.createRef(),t.canvasContext=null,t.getRelativeBlockSize=z()((function(e){var n=e.canvasWidth,t=e.canvasHeight,r=e.boardSize;return{width:n/r,height:t/r}})),t.drawRect=function(e){var n=t.canvasContext,r=t.getRelativeBlockSize(function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?W(t,!0).forEach((function(n){Object(E.a)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):W(t).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}({},t.state,{boardSize:t.props.boardSize})),o=r.width,a=r.height;if(n){var i=e.posX,c=e.posY,l=e.block,u=l.value,s=M[u],d=s.r,h=s.g,g=s.b,v=i*o,f=c*a;n.fillStyle="rgba(".concat(d,", ").concat(h,", ").concat(g,", 0.8)"),n.fillRect(f,v,o,a),n.fillStyle="".concat(m.primaryTextColor),n.font="2.0rem Noto Sans KR",n.textAlign="center",n.fillText("".concat(l.value),f+o/2,v+a/2)}},t.renderBoard=function(e){var n=t.props.boardSize,r=t.state,o=r.canvasWidth,a=r.canvasHeight;t.canvasContext&&t.canvasContext.clearRect(0,0,o,a);for(var i=0;i<n;i++)for(var c=0;c<n;c++){var l=e[i][c];l.value&&t.drawRect({posX:i,posY:c,block:l})}},t.initializeGameEngine=function(){var e=t.props.boardSize;t.engine.initializeBoard({boardSize:e,onBoardChange:t.handleBoardChange,onGameEnd:t.handleGameEnd}),console.info("[\u2714\ufe0f] Success to initialize Game engine")},t.initializeCanvas=function(){var e=t.refCanvasBoard.current;e?(t.canvasContext=e.getContext("2d"),t.canvasContext&&(console.info("[\u2714\ufe0f] Success to initialize canvas"),t.setState({canvasWidth:e.width,canvasHeight:e.height}),t.renderBoard(t.engine.getBoard()),t.registerKeyboardInput())):console.error("[\u274c] Failed to initialize canvas")},t.registerKeyboardInput=function(){window?(window.addEventListener("keydown",t.debounceKeyDown),console.info("[\u2714\ufe0f] Success to register keyboard input")):console.error("[\u274c] Failed to register keyboard input")},t.handleBoardChange=function(e){console.log("!!!! handleBoardChange",e),t.renderBoard(e)},t.handleGameEnd=function(){alert(" - GAME END - ")},t.handleArrowKey=function(e){var n=null;switch(e.keyCode){case 37:console.log("KeyInput: left arrow"),n="left";break;case 38:console.log("KeyInput: up arrow"),n="up";break;case 39:console.log("KeyInput: right arrow"),n="right";break;case 40:console.log("KeyInput: down arrow"),n="down"}n&&t.engine.move(n)},t.debounceKeyDown=S()(t.handleArrowKey,150),t}return Object(f.a)(n,e),Object(h.a)(n,[{key:"componentDidMount",value:function(){this.initializeGameEngine(),this.initializeCanvas()}},{key:"render",value:function(){var e=this.props,n=e.width,t=e.height;return o.createElement(R,{width:n,height:t,ref:this.refCanvasBoard})}}]),n}(o.PureComponent),J=function(e){function n(){return Object(d.a)(this,n),Object(g.a)(this,Object(v.a)(n).apply(this,arguments))}return Object(f.a)(n,e),Object(h.a)(n,[{key:"render",value:function(){return o.createElement(j,null,o.createElement("title",null,o.createElement("h1",null,"Single play mode")),o.createElement("div",null,o.createElement(N,{width:500,height:500,boardSize:4})))}}]),n}(o.PureComponent);function F(){var e=Object(r.a)(["\n  html,\n  body {\n    margin: 0;\n    padding: 0;\n    font-size: 10px;\n  }\n\n  * {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n    font-family: 'Noto Sans KR', sans-serif;\n  }\n\n  #root,\n  body {\n    width: 100vw;\n    height: 100vh;\n  }\n"]);return F=function(){return e},e}var H=Object(l.b)(F()),T=Object(s.a)();c.a.render(a.a.createElement(l.a,{theme:{}},a.a.createElement(a.a.Fragment,null,a.a.createElement(H,null),a.a.createElement(u.b,{history:T},a.a.createElement(u.c,null,a.a.createElement(u.a,{path:"/single",exact:!0,component:J}),a.a.createElement(u.a,{path:"/",component:k}))))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[38,1,2]]]);
//# sourceMappingURL=main.cecf6bdb.chunk.js.map